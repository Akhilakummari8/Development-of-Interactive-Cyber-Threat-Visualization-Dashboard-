import pandas as pd
import plotly.express as px

# Load data (assuming sales_data_5_years.csv is available in the environment)
df_sales = pd.read_csv("sales_data_5_years.csv")
df_sales["date"] = pd.to_datetime(df_sales["date"])

# Apply default filters to match the Streamlit app's initial state
# (selecting all regions, all categories, and the full date range)
region_filter = df_sales["region"].unique()
category_filter = df_sales["category"].unique()
date_range_filter = [df_sales["date"].min(), df_sales["date"].max()]

filtered_df_for_chart = df_sales[
    (df_sales["region"].isin(region_filter)) &
    (df_sales["category"].isin(category_filter)) &
    (df_sales["date"] >= pd.to_datetime(date_range_filter[0])) &
    (df_sales["date"] <= pd.to_datetime(date_range_filter[1]))
]

# Create the Sales by Category pie chart with a predefined color sequence
fig_category = px.pie(
    filtered_df_for_chart,
    values="sales",
    names="category",
    title="Sales by Category",
    color_discrete_sequence=px.colors.sequential.RdBu # Example: using a sequential color scheme
)

# Display the chart
fig_category.show()
